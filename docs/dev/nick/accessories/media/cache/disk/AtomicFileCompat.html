<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="zh">
<head>
<!-- Generated by javadoc (1.8.0_91) on Fri Aug 26 09:50:52 CST 2016 -->
<title>AtomicFileCompat</title>
<meta name="date" content="2016-08-26">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="AtomicFileCompat";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":42,"i6":10,"i7":10,"i8":10,"i9":42};
var tabs = {65535:["t0","���з���"],2:["t2","ʵ������"],8:["t4","���巽��"],32:["t6","�ѹ�ʱ�ķ���"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>����������ѽ��� JavaScript��</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="������������">������������</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="����">
<li><a href="../../../../../../overview-summary.html">����</a></li>
<li><a href="package-summary.html">�����</a></li>
<li class="navBarCell1Rev">��</li>
<li><a href="package-tree.html">��</a></li>
<li><a href="../../../../../../deprecated-list.html">�ѹ�ʱ</a></li>
<li><a href="../../../../../../index-files/index-1.html">����</a></li>
<li><a href="../../../../../../help-doc.html">����</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>��һ����</li>
<li><a href="../../../../../../dev/nick/accessories/media/cache/disk/DiskCache.html" title="dev.nick.accessories.media.loader.cache.disk�е���"><span class="typeNameLink">��һ����</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?dev/nick/accessories/media/cache/disk/AtomicFileCompat.html" target="_top">���</a></li>
<li><a href="AtomicFileCompat.html" target="_top">�޿��</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../allclasses-noframe.html">������</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>��Ҫ:&nbsp;</li>
<li>Ƕ��&nbsp;|&nbsp;</li>
<li>�ֶ�&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">������</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">����</a></li>
</ul>
<ul class="subNavList">
<li>��ϸ����:&nbsp;</li>
<li>�ֶ�&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">������</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">����</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">dev.nick.accessories.media.loader.cache.disk</div>
<h2 title="�� AtomicFileCompat" class="title">�� AtomicFileCompat</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>dev.nick.accessories.media.loader.cache.disk.AtomicFileCompat</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="typeNameLabel">AtomicFileCompat</span>
extends java.lang.Object</pre>
<div class="block">Helper class for performing atomic operations on a file by creating a
 backup file until a write has successfully completed.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>��������Ҫ</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="��������Ҫ��, �б������ͽ���">
<caption><span>������</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">��������˵��</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../../../dev/nick/accessories/media/cache/disk/AtomicFileCompat.html#AtomicFileCompat-java.io.File-">AtomicFileCompat</a></span>(java.io.File&nbsp;baseName)</code>
<div class="block">Create a new AtomicFileCompat for a file located at the given File path.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>������Ҫ</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="������Ҫ��, �б����ͽ���">
<caption><span id="t0" class="activeTableTab"><span>���з���</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">ʵ������</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">���巽��</a></span><span class="tabEnd">&nbsp;</span></span><span id="t6" class="tableTab"><span><a href="javascript:show(32);">�ѹ�ʱ�ķ���</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">�޶���������</th>
<th class="colLast" scope="col">������˵��</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../dev/nick/accessories/media/cache/disk/AtomicFileCompat.html#delete--">delete</a></span>()</code>
<div class="block">Delete the atomic file.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../dev/nick/accessories/media/cache/disk/AtomicFileCompat.html#failWrite-java.io.FileOutputStream-">failWrite</a></span>(java.io.FileOutputStream&nbsp;str)</code>
<div class="block">Call when you have failed for some reason at writing to the stream
 returned by <a href="../../../../../../dev/nick/accessories/media/cache/disk/AtomicFileCompat.html#startWrite--"><code>startWrite()</code></a>.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../dev/nick/accessories/media/cache/disk/AtomicFileCompat.html#finishWrite-java.io.FileOutputStream-">finishWrite</a></span>(java.io.FileOutputStream&nbsp;str)</code>
<div class="block">Call when you have successfully finished writing to the stream
 returned by <a href="../../../../../../dev/nick/accessories/media/cache/disk/AtomicFileCompat.html#startWrite--"><code>startWrite()</code></a>.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>java.io.File</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../dev/nick/accessories/media/cache/disk/AtomicFileCompat.html#getBaseFile--">getBaseFile</a></span>()</code>
<div class="block">Return the path to the base file.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../dev/nick/accessories/media/cache/disk/AtomicFileCompat.html#getLastModifiedTime--">getLastModifiedTime</a></span>()</code>
<div class="block">Gets the last modified time of the atomic file.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>java.io.FileOutputStream</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../dev/nick/accessories/media/cache/disk/AtomicFileCompat.html#openAppend--">openAppend</a></span>()</code>
<div class="block"><span class="deprecatedLabel">�ѹ�ʱ��</span>&nbsp;
<div class="block"><span class="deprecationComment">This is not safe.</span></div>
</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>java.io.FileInputStream</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../dev/nick/accessories/media/cache/disk/AtomicFileCompat.html#openRead--">openRead</a></span>()</code>
<div class="block">Open the atomic file for reading.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../dev/nick/accessories/media/cache/disk/AtomicFileCompat.html#readFully--">readFully</a></span>()</code>
<div class="block">A convenience for <a href="../../../../../../dev/nick/accessories/media/cache/disk/AtomicFileCompat.html#openRead--"><code>openRead()</code></a> that also reads all of the
 file contents into a byte array which is returned.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>java.io.FileOutputStream</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../dev/nick/accessories/media/cache/disk/AtomicFileCompat.html#startWrite--">startWrite</a></span>()</code>
<div class="block">Start a new write operation on the file.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../dev/nick/accessories/media/cache/disk/AtomicFileCompat.html#truncate--">truncate</a></span>()</code>
<div class="block"><span class="deprecatedLabel">�ѹ�ʱ��</span>&nbsp;
<div class="block"><span class="deprecationComment">This is not safe.</span></div>
</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>����̳еķ���&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>��������ϸ����</h3>
<a name="AtomicFileCompat-java.io.File-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>AtomicFileCompat</h4>
<pre>public&nbsp;AtomicFileCompat(java.io.File&nbsp;baseName)</pre>
<div class="block">Create a new AtomicFileCompat for a file located at the given File path.
 The secondary backup file will be the same file path with ".bak" appended.</div>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>������ϸ����</h3>
<a name="getBaseFile--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getBaseFile</h4>
<pre>public&nbsp;java.io.File&nbsp;getBaseFile()</pre>
<div class="block">Return the path to the base file.  You should not generally use this,
 as the data at that path may not be valid.</div>
</li>
</ul>
<a name="delete--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>delete</h4>
<pre>public&nbsp;void&nbsp;delete()</pre>
<div class="block">Delete the atomic file.  This deletes both the base and backup files.</div>
</li>
</ul>
<a name="startWrite--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>startWrite</h4>
<pre>public&nbsp;java.io.FileOutputStream&nbsp;startWrite()
                                    throws java.io.IOException</pre>
<div class="block">Start a new write operation on the file.  This returns a FileOutputStream
 to which you can write the new file data.  The existing file is replaced
 with the new data.  You must not directly close the given
 FileOutputStream; instead call either <a href="../../../../../../dev/nick/accessories/media/cache/disk/AtomicFileCompat.html#finishWrite-java.io.FileOutputStream-"><code>finishWrite(FileOutputStream)</code></a>
 or <a href="../../../../../../dev/nick/accessories/media/cache/disk/AtomicFileCompat.html#failWrite-java.io.FileOutputStream-"><code>failWrite(FileOutputStream)</code></a>.
 Note that if another thread is currently performing
 a write, this will simply replace whatever that thread is writing
 with the new file being written by this thread, and when the other
 thread finishes the write the new write operation will no longer be
 safe (or will be lost).  You must do your own threading protection for
 access to AtomicFileCompat.</div>
<dl>
<dt><span class="throwsLabel">�׳�:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</li>
</ul>
<a name="finishWrite-java.io.FileOutputStream-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>finishWrite</h4>
<pre>public&nbsp;void&nbsp;finishWrite(java.io.FileOutputStream&nbsp;str)</pre>
<div class="block">Call when you have successfully finished writing to the stream
 returned by <a href="../../../../../../dev/nick/accessories/media/cache/disk/AtomicFileCompat.html#startWrite--"><code>startWrite()</code></a>.  This will close, sync, and
 commit the new data.  The lower attempt to read the atomic file
 will return the new file stream.</div>
</li>
</ul>
<a name="failWrite-java.io.FileOutputStream-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>failWrite</h4>
<pre>public&nbsp;void&nbsp;failWrite(java.io.FileOutputStream&nbsp;str)</pre>
<div class="block">Call when you have failed for some reason at writing to the stream
 returned by <a href="../../../../../../dev/nick/accessories/media/cache/disk/AtomicFileCompat.html#startWrite--"><code>startWrite()</code></a>.  This will close the current
 write stream, and roll back to the previous state of the file.</div>
</li>
</ul>
<a name="truncate--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>truncate</h4>
<pre>@Deprecated
public&nbsp;void&nbsp;truncate()
                           throws java.io.IOException</pre>
<div class="block"><span class="deprecatedLabel">�ѹ�ʱ��</span>&nbsp;<span class="deprecationComment">This is not safe.</span></div>
<dl>
<dt><span class="throwsLabel">�׳�:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</li>
</ul>
<a name="openAppend--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>openAppend</h4>
<pre>@Deprecated
public&nbsp;java.io.FileOutputStream&nbsp;openAppend()
                                                 throws java.io.IOException</pre>
<div class="block"><span class="deprecatedLabel">�ѹ�ʱ��</span>&nbsp;<span class="deprecationComment">This is not safe.</span></div>
<dl>
<dt><span class="throwsLabel">�׳�:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</li>
</ul>
<a name="openRead--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>openRead</h4>
<pre>public&nbsp;java.io.FileInputStream&nbsp;openRead()
                                 throws java.io.FileNotFoundException</pre>
<div class="block">Open the atomic file for reading.  If there previously was an
 incomplete write, this will roll back to the last good data before
 opening for read.  You should call close() on the FileInputStream when
 you are done reading from it.
 Note that if another thread is currently performing
 a write, this will incorrectly consider it to be in the state of a bad
 write and roll back, causing the new data currently being written to
 be dropped.  You must do your own threading protection for access to
 AtomicFileCompat.</div>
<dl>
<dt><span class="throwsLabel">�׳�:</span></dt>
<dd><code>java.io.FileNotFoundException</code></dd>
</dl>
</li>
</ul>
<a name="getLastModifiedTime--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getLastModifiedTime</h4>
<pre>public&nbsp;long&nbsp;getLastModifiedTime()
                         throws java.io.IOException</pre>
<div class="block">Gets the last modified time of the atomic file.</div>
<dl>
<dt><span class="returnLabel">����:</span></dt>
<dd>last modified time in milliseconds since epoch.</dd>
<dt><span class="throwsLabel">�׳�:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</li>
</ul>
<a name="readFully--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>readFully</h4>
<pre>public&nbsp;byte[]&nbsp;readFully()
                 throws java.io.IOException</pre>
<div class="block">A convenience for <a href="../../../../../../dev/nick/accessories/media/cache/disk/AtomicFileCompat.html#openRead--"><code>openRead()</code></a> that also reads all of the
 file contents into a byte array which is returned.</div>
<dl>
<dt><span class="throwsLabel">�׳�:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="������������">������������</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="����">
<li><a href="../../../../../../overview-summary.html">����</a></li>
<li><a href="package-summary.html">�����</a></li>
<li class="navBarCell1Rev">��</li>
<li><a href="package-tree.html">��</a></li>
<li><a href="../../../../../../deprecated-list.html">�ѹ�ʱ</a></li>
<li><a href="../../../../../../index-files/index-1.html">����</a></li>
<li><a href="../../../../../../help-doc.html">����</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>��һ����</li>
<li><a href="../../../../../../dev/nick/accessories/media/cache/disk/DiskCache.html" title="dev.nick.accessories.media.loader.cache.disk�е���"><span class="typeNameLink">��һ����</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?dev/nick/accessories/media/cache/disk/AtomicFileCompat.html" target="_top">���</a></li>
<li><a href="AtomicFileCompat.html" target="_top">�޿��</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../allclasses-noframe.html">������</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>��Ҫ:&nbsp;</li>
<li>Ƕ��&nbsp;|&nbsp;</li>
<li>�ֶ�&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">������</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">����</a></li>
</ul>
<ul class="subNavList">
<li>��ϸ����:&nbsp;</li>
<li>�ֶ�&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">������</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">����</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
